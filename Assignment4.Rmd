---
title: "Assignment4"
author: "Whytne Stevens"
date: "9/24/2020"
output:
  html_document:
    theme: cosmo
    toc: true
    toc_depth: 3
    toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r load libraries}
library(ggplot2)
library(tidycensus)
library(ggthemes)
library(tidyverse)
library(wesanderson)
library(viridis)
```


```{r load data, results='hide'}
person_data_new2 <- read.csv("persondatanew.csv") %>%
mutate(ENG_label = case_when(
    ENG_label=="N/A (less than 5 years old/speaks only English)"~"1N/A (less than 5 years old/speaks only English)",
    ENG_label=="Well"~"Well",
    ENG_label=="Very well"~"Very well",
    ENG_label=="Not well"~"Not well",
    ENG_label=="Not at all"~"Not at all"),
    HHL_label = case_when(
    HHL_label=="English only"~"1English only",
    HHL_label=="Asian and Pacific Island languages"~"Asian and Pacific Island languages",
    HHL_label=="Other Indo-European languages" ~ "Other Indo-European languages",
    HHL_label=="Other language" ~ "Other language",
    HHL_label=="Spanish" ~ "Spanish"),
    COW_label = case_when(
    COW_label=="Employee of a private for-profit company or business, or of an individual, for wages, salary, or commissions" ~ "1Employee of a private for-profit company/business",
    COW_label=="Employee of a private not-for-profit, tax-exempt, or charitable organization" ~ "Employee of a private not-for-profit organization",
    COW_label=="Federal government employee" ~ "Federal government employee",
    COW_label=="Local government employee (city, county, etc.)" ~ "Local government employee",
    COW_label=="State government employee" ~ "State government employee",
    COW_label=="Self-employed in own incorporated business, professional practice or farm"~"Self-employed in own incorporated business, professional practice or farm",
    COW_label=="Self-employed in own not incorporated business, professional practice, or farm" ~ "Self-employed in own not incorporated business, professional practice, or farm",
    COW_label=="Working without pay in family business or farm" ~ "Working without pay in family business or farm"),
    FS_label = case_when(
    FS_label=="No" ~ "1No",
    FS_label=="Yes" ~ "Yes"))

```

# Regression Model For Continuous Variables



# Regression Model for PINCP Variable
```{r}
model <- lm(PINCP ~ COW_label + HHL_label + ENG_label + FS_label + WKHP + POVPIP, 
            data = person_data_new2)
options(scipen = 999)
summary(model)
```
## Results
The multiple R-squared value for this model is 0.3169, meaning that it predicts about 32% of this model

Strong and Significant
-COW_labelFederal government employee, with a coefficient estimate of 84236.21
- WKHP, with a coefficient estimate of 1066.91 
- POVPIP, with a coefficient estimate of 131.88  

When controlled for Employee of a private for-profit company/business, Federal Government Employees make about $84,000 more in income than those in the other COW categories. In addtion, one's income increases by 1066 dollars for every addtional hour they work and their income to poverty ratio increases by a factor of 132 as their income increases



Weak
- COW_labelSelf-employed in own incorporated business, professional practice or farm, with a coefficient estimate of 23195.88

When controlled for Employee of a private for-profit company/business, people who are Self-employed in own incorporated business, professional practice or farm make about $23,000 more in income than those in the other COW categories. 



Very Weak
- HHL_labelOther Indo-European languages, with a coefficient estimate of 19408.35

When controlled for English only, people whose houshold language is under the Other Indo-European languages category make about $19,000 more in income than those in the other HHL categories. 



# Regression Model for WKHP Variable
```{r}
model2 <- lm(WKHP ~ COW_label + HHL_label + ENG_label + FS_label + PINCP + POVPIP, 
            data = person_data_new2)
options(scipen = 999)
summary(model2)
```
## Results
The multiple R-squared values is 0.1272, Predicts about 13% of this model

Strong and Significant
- PINCP, with a coefficient estimate of 0.00007485



Weak
- ENG_labelNot well, with a coefficient estimate of 5.40207333

When controlled for N/A (less than 5 years old/speaks only English), people whose English language proficiency is Not well work about 5 hours more than those in the other ENG categories



Very Weak
- POVPIP, with a coefficient estimate of 0.00708539



# Regression Model for POVPIP Variable
```{r}
model3 <- lm(POVPIP ~ COW_label + HHL_label + ENG_label + FS_label + WKHP + PINCP, 
            data = person_data_new2)
options(scipen = 999)
summary(model3)
```
## Results
The multiple R-squared values is 0.3482, Predicts about 35% of this model

Strong and Significant
- ENG_labelNot well, with a coefficient estimate of -108.5138605
- FS_labelYes, with a coefficient estimate of -81.7288664
- PINCP, with a coefficient estimate of 0.0009376

When controlled for N/A (less than 5 years old/speaks only English), the income to poverty ratio for people whose English language proficiency is Not well is less than those in the other ENG categories by a factor of 109. When controlled for No, the income to poverty ratio for people whose receive Food Stamps is less than those who don't receive Food Stamps by a factor of 82



Significant
- COW_labelEmployee of a private not-for-profit organization, with a coefficient estimate of 67.0897929

When controlled for Employee of a private for-profit company/business, the income to poverty ratio for people who are Employees of a private not-for-profit organization is greater than those in the other ENG categories by a factor of 67.




Weak
- COW_labelLocal government employee, with a coefficient estimate of 43.7144380
- COW_labelSelf-employed in own not incorporated business, professional practice, or farm, with a coefficient estimate of -42.8613915
- ENG_labelNot at all, with a coefficient estimate of -92.0866650

When controlled for Employee of a private for-profit company/business, the income to poverty ratio for people who are Local government employees is greater than those in the other COW categories by a factor of 44.  When controlled for Employee of a private for-profit company/business, the income to poverty ratio for people who are Self-employed in own not incorporated business, professional practice, or farm is less than those in the other COW categories by a factor of 43. When controlled for N/A (less than 5 years old/speaks only English), the income to poverty ratio for people whose English language proficiency is Not at all less than those in the other ENG categories by a factor of 92




Very Weak
- WKHP, with a coefficient estimate of 0.7180711





